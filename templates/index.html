<!DOCTYPE HTML>
<html lang = 'zh-TW'>
    <head>
        <meta charset = 'UTF-8'>
        <title>è‚¡åƒ¹æŸ¥è©¢</title>
        <style>
            body {
            font-family: Arial, sans-serif;
            margin: 40px;
            background-color: #f9f9f9;
            }

            h2 {
            color: #333;
            }

            input, button {
            padding: 8px 12px;
            font-size: 16px;
            margin-right: 8px;
            }

            button {
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
            }

            button:hover {
            background-color: #45a049;
            }

            #result {
            background-color: #fff;
            padding: 16px;
            margin-top: 20px;
            border: 1px solid #ddd;
            white-space: pre-wrap;
            }

            .error {
            color: red;
            font-weight: bold;
            }
        </style>
    </head>
    <body>
        <h2>è«‹è¼¸å…¥è‚¡ç¥¨ä»£è™ŸæŸ¥è©¢è‚¡ç¥¨è³‡è¨Š</h2>
        <input type="text" id = codeinput placeholder="è«‹è¼¸å…¥è‚¡ç¥¨ä»£è™Ÿ ( ä¾‹ï¼š2330 )">
        <input type="text" id = priceinpit placeholder="è«‹è¼¸å…¥ç›®æ¨™è‚¡åƒ¹ ( é¸å¡« )">
        <button onclick="search()">æŸ¥è©¢</button>

        <div id = 'result'></div>

        <script>
            async function search() {
                const code = document.getElementById('codeinput').value.trim();
                const target = document.getElementById('priceinput').value.trim();
                const resultDiv = document.getElementById('result');
                
                if(!code){
                    resultDiv.innerHTML = '<span class = "error">è«‹è¼¸å…¥è‚¡ç¥¨ä»£è™Ÿ</span>';
                    return;
                }

                resultDiv.innerHTML = 'æŸ¥è©¢ä¸­...';
                // if(resultDiv.innerHTML == 'æŸ¥è©¢ä¸­'){
                //     resultDiv.innerHTML = 'æŸ¥è©¢ä¸­.'
                // }
                // else if (resultDiv.innerHTML == 'æŸ¥è©¢ä¸­.'){
                //     resultDiv.innerHTML = 'æŸ¥è©¢ä¸­..'
                // }
                // else if (resultDiv.innerHTML == 'æŸ¥è©¢ä¸­..'){
                //     resultDiv.innerHTML = 'æŸ¥è©¢ä¸­...'
                // }
                // else if (resultDiv.innerHTML == 'æŸ¥è©¢ä¸­...'){
                //     resultDiv.innerHTML = 'æŸ¥è©¢ä¸­'
                // }

                const response = await fetch(`/stock/${code}?target=${target}`);
                const data = await response.json();

                // if(data.status){
                //     resultDiv.textContent = JSON.stringify(data,null,2); 
                // }
                if(data.status==='Success'){
                    resultDiv.innerHTML = `
                    ğŸ“ˆ è‚¡ç¥¨åç¨±ï¼š${data.stock_name} ( ${data.stock_num} )<br>
                    ğŸ’µ è‚¡åƒ¹ï¼š${data.stock_price} å…ƒ${data.currency}<br>
                    ğŸ•˜ æ“·å–æ™‚é–“ï¼š${data.time}
                    `;
                }else{
                    resultDiv.innerHTML = `<span class = 'error'>æŸ¥ç„¡æ­¤è‚¡ç¥¨ä»£è™Ÿï¼š${code}</span>`
                }
            }
        </script>
    </body>
</html>
